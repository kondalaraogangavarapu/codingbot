<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Repository Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .login-section {
            margin-bottom: 30px;
        }

        .github-btn {
            background: #24292e;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
            text-decoration: none;
        }

        .github-btn:hover {
            background: #1a1e22;
        }

        .github-icon {
            width: 20px;
            height: 20px;
        }

        .user-info {
            display: none;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 10px;
        }

        .user-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .user-username {
            color: #666;
            margin-bottom: 10px;
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .logout-btn:hover {
            background: #c82333;
        }

        .repos-section {
            display: none;
        }

        .repos-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .repos-title {
            font-size: 1.5rem;
            color: #333;
        }

        .repos-count {
            background: #007bff;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }

        .repo-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
        }

        .repo-item {
            padding: 16px;
            border-bottom: 1px solid #e1e4e8;
            text-align: left;
            transition: background-color 0.2s;
        }

        .repo-item:last-child {
            border-bottom: none;
        }

        .repo-item:hover {
            background-color: #f6f8fa;
        }

        .repo-name {
            font-weight: bold;
            color: #0366d6;
            text-decoration: none;
            font-size: 1.1rem;
            margin-bottom: 5px;
            display: block;
        }

        .repo-name:hover {
            text-decoration: underline;
        }

        .repo-description {
            color: #586069;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .repo-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: #586069;
        }

        .repo-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .language-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .error {
            color: #dc3545;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 12px;
            border-radius: 4px;
            margin: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            .repos-header {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">üêô GitHub Repo Viewer</div>
        <div class="subtitle">View and explore your GitHub repositories</div>

        <div class="login-section" id="loginSection">
            <button class="github-btn" onclick="loginWithGitHub()">
                <svg class="github-icon" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                Login with GitHub
            </button>
        </div>

        <div class="user-info" id="userInfo">
            <img class="user-avatar" id="userAvatar" src="" alt="User Avatar">
            <div class="user-name" id="userName"></div>
            <div class="user-username" id="userUsername"></div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="repos-section" id="reposSection">
            <div class="repos-header">
                <h2 class="repos-title">Your Repositories</h2>
                <span class="repos-count" id="reposCount">0</span>
            </div>
            <div id="reposContent">
                <div class="loading">Loading repositories...</div>
            </div>
        </div>
    </div>

    <script>
        // GitHub OAuth configuration
        const CLIENT_ID = 'YOUR_GITHUB_CLIENT_ID'; // You'll need to replace this
        const REDIRECT_URI = window.location.origin + window.location.pathname;
        
        // Language colors for GitHub repositories
        const languageColors = {
            'JavaScript': '#f1e05a',
            'TypeScript': '#2b7489',
            'Python': '#3572A5',
            'Java': '#b07219',
            'C++': '#f34b7d',
            'C': '#555555',
            'C#': '#239120',
            'PHP': '#4F5D95',
            'Ruby': '#701516',
            'Go': '#00ADD8',
            'Rust': '#dea584',
            'Swift': '#ffac45',
            'Kotlin': '#F18E33',
            'HTML': '#e34c26',
            'CSS': '#563d7c',
            'Shell': '#89e051',
            'Dockerfile': '#384d54'
        };

        // Check for access token on page load
        window.addEventListener('load', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            const storedToken = localStorage.getItem('github_access_token');

            if (code && !storedToken) {
                // Exchange code for access token
                exchangeCodeForToken(code);
            } else if (storedToken) {
                // User is already logged in
                showUserInfo();
                loadRepositories();
            }
        });

        function loginWithGitHub() {
            if (CLIENT_ID === 'YOUR_GITHUB_CLIENT_ID') {
                showError('Please configure your GitHub OAuth App first. See instructions below.');
                return;
            }
            
            const authUrl = `https://github.com/login/oauth/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=repo,user`;
            window.location.href = authUrl;
        }

        async function exchangeCodeForToken(code) {
            try {
                // Note: In a real application, this should be done on your backend server
                // for security reasons. This is a simplified example.
                showError('OAuth token exchange needs to be implemented on a backend server for security. For now, you can manually set your GitHub Personal Access Token in localStorage with key "github_access_token".');
                
                // Clear the code from URL
                window.history.replaceState({}, document.title, window.location.pathname);
            } catch (error) {
                showError('Failed to authenticate with GitHub: ' + error.message);
            }
        }

        async function showUserInfo() {
            try {
                const token = localStorage.getItem('github_access_token');
                if (!token) {
                    return;
                }

                const response = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch user info');
                }

                const user = await response.json();
                
                document.getElementById('userAvatar').src = user.avatar_url;
                document.getElementById('userName').textContent = user.name || user.login;
                document.getElementById('userUsername').textContent = `@${user.login}`;
                
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('userInfo').style.display = 'block';
                document.getElementById('reposSection').style.display = 'block';
                
            } catch (error) {
                showError('Failed to load user information: ' + error.message);
                logout();
            }
        }

        async function loadRepositories() {
            try {
                const token = localStorage.getItem('github_access_token');
                if (!token) {
                    return;
                }

                const reposContent = document.getElementById('reposContent');
                reposContent.innerHTML = '<div class="loading">Loading repositories...</div>';

                // Fetch repositories with pagination
                let allRepos = [];
                let page = 1;
                let hasMore = true;

                while (hasMore) {
                    const response = await fetch(`https://api.github.com/user/repos?sort=updated&per_page=100&page=${page}`, {
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });

                    if (!response.ok) {
                        throw new Error('Failed to fetch repositories');
                    }

                    const repos = await response.json();
                    allRepos = allRepos.concat(repos);
                    
                    if (repos.length < 100) {
                        hasMore = false;
                    } else {
                        page++;
                    }
                }

                displayRepositories(allRepos);
                
            } catch (error) {
                showError('Failed to load repositories: ' + error.message);
            }
        }

        function displayRepositories(repos) {
            const reposContent = document.getElementById('reposContent');
            const reposCount = document.getElementById('reposCount');
            
            reposCount.textContent = repos.length;

            if (repos.length === 0) {
                reposContent.innerHTML = '<div class="loading">No repositories found.</div>';
                return;
            }

            const repoList = document.createElement('div');
            repoList.className = 'repo-list';

            repos.forEach(repo => {
                const repoItem = document.createElement('div');
                repoItem.className = 'repo-item';

                const languageColor = languageColors[repo.language] || '#586069';
                const updatedDate = new Date(repo.updated_at).toLocaleDateString();

                repoItem.innerHTML = `
                    <a href="${repo.html_url}" target="_blank" class="repo-name">${repo.name}</a>
                    <div class="repo-description">${repo.description || 'No description available'}</div>
                    <div class="repo-meta">
                        ${repo.language ? `
                            <div class="repo-meta-item">
                                <div class="language-color" style="background-color: ${languageColor}"></div>
                                ${repo.language}
                            </div>
                        ` : ''}
                        <div class="repo-meta-item">
                            ‚≠ê ${repo.stargazers_count}
                        </div>
                        <div class="repo-meta-item">
                            üç¥ ${repo.forks_count}
                        </div>
                        <div class="repo-meta-item">
                            üìÖ Updated ${updatedDate}
                        </div>
                        ${repo.private ? '<div class="repo-meta-item">üîí Private</div>' : ''}
                    </div>
                `;

                repoList.appendChild(repoItem);
            });

            reposContent.innerHTML = '';
            reposContent.appendChild(repoList);
        }

        function logout() {
            localStorage.removeItem('github_access_token');
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('reposSection').style.display = 'none';
            clearError();
        }

        function showError(message) {
            clearError();
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            document.querySelector('.container').appendChild(errorDiv);
        }

        function clearError() {
            const existingError = document.querySelector('.error');
            if (existingError) {
                existingError.remove();
            }
        }

        // Add instructions for setting up GitHub OAuth
        if (CLIENT_ID === 'YOUR_GITHUB_CLIENT_ID') {
            setTimeout(() => {
                showError(`
                    To use this app, you need to:
                    1. Create a GitHub OAuth App at https://github.com/settings/applications/new
                    2. Set the Authorization callback URL to: ${window.location.origin}${window.location.pathname}
                    3. Replace 'YOUR_GITHUB_CLIENT_ID' in the code with your actual Client ID
                    4. For testing, you can create a Personal Access Token at https://github.com/settings/tokens and store it in localStorage with key 'github_access_token'
                `);
            }, 1000);
        }
    </script>
</body>
</html>